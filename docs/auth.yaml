components:
  schemas:
    OAuthLoginInput:
      type: object
      required: [idToken]
      properties:
        idToken:
          type: string
          description: Firebase ID Token (Google/Apple/any provider)

paths:
  /auth/oauth:
    post:
      tags: [Auth]
      summary: Login via Firebase ID token (Google/Apple/any)
      description: |
        Bootstrap auth endpoint using Firebase ID token.
        Route has no auth middleware chain (public endpoint); controller verifies the provided token in service layer.
        Backend emits auth analytics (`auth_completed` / `auth_failed`) and auth domain logs.
      operationId: oauthLogin
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthLoginInput'
      responses:
        "200":
          description: Authenticated user
          content:
            application/json:
              schema:
                allOf:
                  - $ref: './common.yaml#/components/schemas/ApiSuccess'
                  - properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: './users.yaml#/components/schemas/User'
        "400":
          description: Missing idToken
          content:
            application/json:
              schema:
                $ref: './common.yaml#/components/schemas/ApiError'
        "401":
          description: Invalid or expired token
          content:
            application/json:
              schema:
                $ref: './common.yaml#/components/schemas/ApiError'
        "500":
          description: Auth error
          content:
            application/json:
              schema:
                $ref: './common.yaml#/components/schemas/ApiError'
