# JM Showroomer Backend

## Для кого цей документ
Цей файл написаний простою мовою для бізнес-сторони.
Тут лише головне: що робить бекенд, що вже реалізовано і як працюють ключові сценарії.

## Що робить бекенд
JM Showroomer Backend:
- приймає авторизацію користувачів через Firebase;
- зберігає дані у Firestore;
- керує ролями й доступами;
- підтримує життєвий цикл шоурумів (чернетка, модерація, публікація);
- віддає публічні списки шоурумів, лукбуків та подій;
- зберігає обрані (favorites / want-to-visit);
- перевіряє валідність даних і бізнес-правил.

## Що вже реалізовано (MVP1)
- Авторизація користувачів (Google/Apple через Firebase ID token).
- Онбординг і профіль користувача.
- Ролі: `guest`, `user`, `owner`, `admin`.
- Повний флоу шоурумів: draft -> submit -> approve/reject -> delete.
- Пошук і фільтрація шоурумів (місто, категорії, гео, пагінація).
- Lookbooks:
  - публічний список і детальна сторінка;
  - лайк/анлайк для авторизованих і гостей;
  - guest sync після логіну.
- Events:
  - публічний список і детальна сторінка;
  - want-to-visit / dismiss;
  - guest sync після логіну.
- Collections:
  - favorites showrooms;
  - favorites lookbooks;
  - want-to-visit events.
- Блокування непідтримуваних країн (russia, belarus).
- Валідації (назви, телефону, Instagram, геоданих).
- API документація в OpenAPI (`/docs`).

Важливо для MVP1:
- Лукбуки та івенти наповнюються через seed/admin процес (не через користувацький UI).
- Користувачі/owner у застосунку створюють тільки шоуруми.

## Основні флоу (бізнес-рівень)

### 1) Користувач
1. Входить у застосунок.
2. Проходить онбординг.
3. За потреби заповнює owner-профіль і стає `owner`.

### 2) Власник шоуруму (owner)
1. Створює чернетку шоуруму.
2. Заповнює дані поетапно.
3. Відправляє на модерацію (`pending`).
4. Адмін схвалює (`approved`) або відхиляє (`rejected`).

### 3) Адміністратор
- Переглядає заявки.
- Підтверджує або відхиляє шоуруми.
- Може видаляти шоуруми за правилами системи.

### 4) Favorites/likes і guest sync
- Гість може додавати в обране на фронтенді.
- Після логіну ці дані синхронізуються з акаунтом користувача.
- Для lookbooks прямий favorite API — тільки для авторизованих; guest використовує local state + sync.
- Для lookbooks лайки та лічильники після sync узгоджуються коректно.

## Бізнес-логіка доступів
- `guest`: публічний перегляд контенту.
- `user`: профіль і базові користувацькі дії.
- `owner`: робота зі своїми шоурумами.
- `admin`: модерація та адміністративні дії.

## Що важливо для клієнта (Flutter)
- Працювати тільки за API-контрактом (`/docs`, `docs/openapi.yaml`).
- Для пагінації використовувати тільки `meta.nextCursor` від бекенду.
- Для guest-favorite сценаріїв зберігати локальний стан та синхронізувати після логіну.
- Після логіну викликати sync endpoints для перенесення локальних станів у профіль.

## Де дивитися деталі
- Для Flutter інтеграції: `docs/readme/README_DETAIL.md`
- Для пошуку шоурумів: `docs/readme/SHOWROOMS_MVP1_SEARCH.md`
- Для технічної карти бекенду: `docs/readme/README_BACKEND_MAP_UA.md`
- Для dev/runbook: `docs/readme/DEV.md`
- Для ручних API перевірок: `docs/readme/DEV_POSTMAN_TESTS.md`
